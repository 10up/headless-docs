<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>Setting up the framework manually | 10up&#39;s Headless Framework (BETA)</title><meta name="description" content="Documentation for 10up's Headless Framework (BETA)"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script async src="../assets/search.js" id="search-script"></script><link rel="stylesheet" href="../assets/code-blocks.css"/><link rel="stylesheet" href="../assets/pages.css"/></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base=".."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">10up&#39;s Headless Framework (BETA)</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><ul class="tsd-breadcrumb"><li><a href="../modules.html">10up&#39;s Headless Framework (BETA)</a></li><li><a href="installing-from-scratch.html">Setting up the framework manually</a></li></ul><h1> Setting up the framework manually </h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><div class="tsd-panel tsd-typography"><p>The recommended way to get started with the framework is by installing the official started project. See <a href="http://docs.headless.10up.com/pages/getting-started.html">Getting Started</a> for more information.</p>
<p>This guide will help you set up the framework in a clean Next.js project.</p>

<a href="#bootstrap-the-nextjs-project" id="bootstrap-the-nextjs-project" style="color: inherit; text-decoration: none;">
  <h2>Bootstrap the Next.js project</h2>
</a>
<p>Start by bootstraping your next.js project.</p>
<pre><code class="language-bash"><span class="hl-1">npx create-next-app@latest --use-npm</span>
</code></pre>
<p>and install the following packages</p>
<pre><code><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-0">install</span><span class="hl-1"> --</span><span class="hl-0">save</span><span class="hl-1"> @10</span><span class="hl-0">up</span><span class="hl-1">/</span><span class="hl-0">headless</span><span class="hl-1">-</span><span class="hl-0">core</span><span class="hl-1"> @10</span><span class="hl-0">up</span><span class="hl-1">/</span><span class="hl-0">headless</span><span class="hl-1">-</span><span class="hl-0">next</span>
</code></pre>

<a href="#headlessconfigjs" id="headlessconfigjs" style="color: inherit; text-decoration: none;">
  <h3>headless.config.js</h3>
</a>
<p>Create a <code>headless.config.js</code> file at the root of your Next.js project.</p>
<pre><code class="language-js"><span class="hl-11">/**</span><br/><span class="hl-11"> * Headless Config</span><br/><span class="hl-11"> *</span><br/><span class="hl-11"> * </span><span class="hl-7">@type</span><span class="hl-11"> </span><span class="hl-5">{import(&#39;@10up/headless-core&#39;).HeadlessConfig}</span><br/><span class="hl-11"> */</span><br/><span class="hl-5">module</span><span class="hl-1">.</span><span class="hl-5">exports</span><span class="hl-1"> = {</span><br/><span class="hl-1">    </span><span class="hl-0">sourceUrl:</span><span class="hl-1"> </span><span class="hl-0">process</span><span class="hl-1">.</span><span class="hl-0">env</span><span class="hl-1">.</span><span class="hl-10">NEXT_PUBLIC_HEADLESS_WP_URL</span><span class="hl-1">,</span><br/><br/><span class="hl-1">    </span><span class="hl-0">useWordPressPlugin:</span><span class="hl-1"> </span><span class="hl-7">true</span><span class="hl-1">,</span><br/><span class="hl-1">};</span>
</code></pre>

<a href="#env-variables" id="env-variables" style="color: inherit; text-decoration: none;">
  <h3>Env variables</h3>
</a>
<p>Then create a <code>.env</code> (or <code>.env.local</code>) with the following contents:</p>
<pre><code><span class="hl-10">NEXT_PUBLIC_HEADLESS_WP_URL</span><span class="hl-1">=</span><span class="hl-14">https</span><span class="hl-1">:</span><span class="hl-11">//my-wordpress.test</span>
</code></pre>
<p>You can call the env variable anything you want, just make sure to update <code>headless.config.js</code> accordingly.</p>
<p>If you&#39;re developing locally and your WordPress instance uses https but does not have a valid cert, add <code>NODE_TLS_REJECT_UNAUTHORIZED=0</code> to your env variables.</p>

<a href="#nextconfigjs" id="nextconfigjs" style="color: inherit; text-decoration: none;">
  <h3>next.config.js</h3>
</a>
<p>Create a <code>next.config.js</code> file with the following contents:</p>
<pre><code class="language-js"><span class="hl-11">// next.config.js</span><br/><span class="hl-7">const</span><span class="hl-1"> { </span><span class="hl-10">withHeadlessConfig</span><span class="hl-1"> } = </span><span class="hl-9">require</span><span class="hl-1">(</span><span class="hl-3">&#39;@10up/headless-next/config&#39;</span><span class="hl-1">);</span><br/><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-10">headlessConfig</span><span class="hl-1"> = </span><span class="hl-9">require</span><span class="hl-1">(</span><span class="hl-3">&#39;./headless.config&#39;</span><span class="hl-1">);</span><br/><br/><span class="hl-11">/**</span><br/><span class="hl-11"> * Update whatever you need within the nextConfig object.</span><br/><span class="hl-11"> *</span><br/><span class="hl-11"> * </span><span class="hl-7">@type</span><span class="hl-11"> </span><span class="hl-5">{import(&#39;next&#39;).NextConfig}</span><br/><span class="hl-11"> */</span><br/><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-10">nextConfig</span><span class="hl-1"> = {};</span><br/><br/><span class="hl-5">module</span><span class="hl-1">.</span><span class="hl-5">exports</span><span class="hl-1"> = </span><span class="hl-9">withHeadlessConfig</span><span class="hl-1">(</span><span class="hl-0">nextConfig</span><span class="hl-1">, </span><span class="hl-0">headlessConfig</span><span class="hl-1">);</span>
</code></pre>

<a href="#pages_appjs" id="pages_appjs" style="color: inherit; text-decoration: none;">
  <h3>pages/_app.js</h3>
</a>
<p>Create a custom <code>_app.js</code> to wrap the application with <code>HeadlessApp</code> component.</p>
<pre><code class="language-js"><span class="hl-2">import</span><span class="hl-1"> { </span><span class="hl-0">HeadlessApp</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&#39;@10up/headless-next&#39;</span><span class="hl-1">;</span><br/><span class="hl-2">import</span><span class="hl-1"> </span><span class="hl-0">Link</span><span class="hl-1"> </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&#39;next/link&#39;</span><span class="hl-1">;</span><br/><span class="hl-2">import</span><span class="hl-1"> </span><span class="hl-0">Router</span><span class="hl-1"> </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&#39;next/router&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-2">import</span><span class="hl-1"> </span><span class="hl-3">&#39;../styles.css&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-9">MyApp</span><span class="hl-1"> = ({ </span><span class="hl-0">Component</span><span class="hl-1">, </span><span class="hl-0">pageProps</span><span class="hl-1"> }) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-11">// only HeadlessApp needs fallback and themeJson, so we remove them from the props we pass down to the pages</span><br/><br/><span class="hl-1">    </span><span class="hl-11">// eslint-disable-next-line react/prop-types, no-unused-vars</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> { </span><span class="hl-10">fallback</span><span class="hl-1"> = {}, </span><span class="hl-10">themeJson</span><span class="hl-1"> = {}, ...</span><span class="hl-10">props</span><span class="hl-1"> } = </span><span class="hl-0">pageProps</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-2">return</span><span class="hl-1"> (</span><br/><span class="hl-1">        </span><span class="hl-4">&lt;</span><span class="hl-5">HeadlessApp</span><br/><span class="hl-1">            </span><span class="hl-6">pageProps</span><span class="hl-1">=</span><span class="hl-7">{</span><span class="hl-0">pageProps</span><span class="hl-7">}</span><br/><span class="hl-1">            </span><span class="hl-6">settings</span><span class="hl-1">=</span><span class="hl-7">{</span><span class="hl-8">{</span><br/><span class="hl-8">                </span><span class="hl-11">// instruct the framework to use Next.js link component or your own version</span><br/><span class="hl-8">                </span><span class="hl-0">linkComponent:</span><span class="hl-8"> </span><span class="hl-0">Link</span><span class="hl-8">,</span><br/><span class="hl-8">            }</span><span class="hl-7">}</span><br/><span class="hl-1">        </span><span class="hl-4">&gt;</span><br/><span class="hl-1">            </span><span class="hl-4">&lt;</span><span class="hl-5">Component</span><span class="hl-1"> </span><span class="hl-7">{</span><span class="hl-1">...</span><span class="hl-0">props</span><span class="hl-7">}</span><span class="hl-1"> </span><span class="hl-4">/&gt;</span><br/><span class="hl-1">        </span><span class="hl-4">&lt;/</span><span class="hl-5">HeadlessApp</span><span class="hl-4">&gt;</span><br/><span class="hl-1">    );</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-2">export</span><span class="hl-1"> </span><span class="hl-2">default</span><span class="hl-1"> </span><span class="hl-0">MyApp</span><span class="hl-1">;</span>
</code></pre>

<a href="#setting-up-the-preview-endpoint" id="setting-up-the-preview-endpoint" style="color: inherit; text-decoration: none;">
  <h3>Setting up the preview endpoint</h3>
</a>
<p>The WordPress plugin expects the preview endpoint to be located at <code>/api/preview</code>.</p>
<p>To enable support for previews, create a <code>pages/api/preview.js</code> with the following contents:</p>
<pre><code class="language-js"><span class="hl-2">import</span><span class="hl-1"> { </span><span class="hl-0">previewHandler</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&#39;@10up/headless-next&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-11">/**</span><br/><span class="hl-11"> * The Preview endpoint just needs to proxy the default preview handler</span><br/><span class="hl-11"> *</span><br/><span class="hl-11"> * </span><span class="hl-7">@param</span><span class="hl-11"> </span><span class="hl-5">{*}</span><span class="hl-11"> </span><span class="hl-0">req</span><span class="hl-11"> Next.js request object</span><br/><span class="hl-11"> * </span><span class="hl-7">@param</span><span class="hl-11"> </span><span class="hl-5">{*}</span><span class="hl-11"> </span><span class="hl-0">res</span><span class="hl-11">  Next.js response object</span><br/><span class="hl-11"> *</span><br/><span class="hl-11"> * </span><span class="hl-7">@returns</span><br/><span class="hl-11"> */</span><br/><span class="hl-2">export</span><span class="hl-1"> </span><span class="hl-2">default</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> </span><span class="hl-7">function</span><span class="hl-1"> </span><span class="hl-9">handler</span><span class="hl-1">(</span><span class="hl-0">req</span><span class="hl-1">, </span><span class="hl-0">res</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-2">return</span><span class="hl-1"> </span><span class="hl-9">previewHandler</span><span class="hl-1">(</span><span class="hl-0">req</span><span class="hl-1">, </span><span class="hl-0">res</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code></pre>

<a href="#creating-your-first-route" id="creating-your-first-route" style="color: inherit; text-decoration: none;">
  <h3>Creating your first route</h3>
</a>
<p>To make sure everything is working as expected create a route catch-all route called <code>pages/[...path].js</code>. This route will be responsible for rendering single post and pages.</p>
<p>By creating a <code>[...path].js</code> route, the framework will automatically detect and extract URL parameters from the <code>path</code> argument.</p>
<pre><code class="language-js"><span class="hl-11">// pages/[...path].js</span><br/><br/><span class="hl-2">import</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">usePost</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">fetchHookData</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">addHookData</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">handleError</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">usePosts</span><br/><span class="hl-1">} </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&#39;@10up/headless-next&#39;</span><span class="hl-1">;</span><br/><span class="hl-2">import</span><span class="hl-1"> { </span><span class="hl-0">BlocksRenderer</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&#39;@10up/headless-core/react&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-10">params</span><span class="hl-1"> = { </span><span class="hl-0">postType:</span><span class="hl-1"> [</span><span class="hl-3">&#39;post&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;page&#39;</span><span class="hl-1"> ] };</span><br/><br/><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-9">SinglePostsPage</span><span class="hl-1"> = () </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> { </span><span class="hl-10">loading</span><span class="hl-1">, </span><span class="hl-10">error</span><span class="hl-1">, </span><span class="hl-10">data</span><span class="hl-1"> } = </span><span class="hl-9">usePost</span><span class="hl-1">(</span><span class="hl-0">params</span><span class="hl-1">);</span><br/><br/><span class="hl-1">    </span><span class="hl-2">if</span><span class="hl-1"> (</span><span class="hl-0">loading</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-2">return</span><span class="hl-1"> </span><span class="hl-3">&#39;Loading...&#39;</span><span class="hl-1">;</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    </span><span class="hl-2">if</span><span class="hl-1"> (</span><span class="hl-0">error</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-2">return</span><span class="hl-1"> </span><span class="hl-3">&#39;error...&#39;</span><span class="hl-1">;</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    </span><span class="hl-2">return</span><span class="hl-1"> (</span><br/><span class="hl-1">        </span><span class="hl-4">&lt;</span><span class="hl-13">div</span><span class="hl-4">&gt;</span><br/><span class="hl-1">            </span><span class="hl-4">&lt;</span><span class="hl-13">h1</span><span class="hl-4">&gt;</span><span class="hl-7">{</span><span class="hl-0">data</span><span class="hl-8">.</span><span class="hl-0">post</span><span class="hl-8">.</span><span class="hl-0">title</span><span class="hl-8">.</span><span class="hl-0">rendered</span><span class="hl-7">}</span><span class="hl-4">&lt;/</span><span class="hl-13">h1</span><span class="hl-4">&gt;</span><br/><span class="hl-1">            </span><span class="hl-4">&lt;</span><span class="hl-5">BlocksRenderer</span><span class="hl-1"> </span><span class="hl-6">html</span><span class="hl-1">=</span><span class="hl-7">{</span><span class="hl-0">data</span><span class="hl-8">.</span><span class="hl-0">post</span><span class="hl-8">.</span><span class="hl-0">content</span><span class="hl-8">.</span><span class="hl-0">rendered</span><span class="hl-7">}</span><span class="hl-1"> </span><span class="hl-4">/&gt;</span><br/><span class="hl-1">        </span><span class="hl-4">&lt;/</span><span class="hl-13">div</span><span class="hl-4">&gt;</span><br/><span class="hl-1">    );</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-2">export</span><span class="hl-1"> </span><span class="hl-2">default</span><span class="hl-1"> </span><span class="hl-0">SinglePostsPage</span><span class="hl-1">;</span>
</code></pre>
<p>Then, visit any single post or page, e.g: <code>http://localhost:3000/hello-world</code> and you should see both the title and the content of that post/page.</p>
<p>Date URLs will also work: e.g: <code>http://localhost:3000/2022/10/2/hello-world</code></p>

<a href="#add-ssrssg" id="add-ssrssg" style="color: inherit; text-decoration: none;">
  <h3>Add SSR/SSG</h3>
</a>
<p>With the example above, you might have noticed that the data is only being fetched on the client. You must use one of the Next.js data fetching methods to enable SSR/SSG.</p>
<p>Add this to the <code>pages/[...path].js</code> file</p>
<pre><code class="language-js"><span class="hl-11">// or export async function getServerSideProps(context)</span><br/><span class="hl-2">export</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> </span><span class="hl-7">function</span><span class="hl-1"> </span><span class="hl-9">getStaticProps</span><span class="hl-1">(</span><span class="hl-0">context</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-2">try</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-11">// make sure to pass the same params to fetchHookData and usePost</span><br/><span class="hl-1">        </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-10">usePostData</span><span class="hl-1"> = </span><span class="hl-2">await</span><span class="hl-1"> </span><span class="hl-9">fetchHookData</span><span class="hl-1">(</span><span class="hl-0">usePost</span><span class="hl-1">.</span><span class="hl-9">fetcher</span><span class="hl-1">(), </span><span class="hl-0">context</span><span class="hl-1">, { </span><span class="hl-0">params</span><span class="hl-1"> });</span><br/><br/><span class="hl-1">        </span><span class="hl-2">return</span><span class="hl-1"> </span><span class="hl-9">addHookData</span><span class="hl-1">([</span><span class="hl-0">usePostData</span><span class="hl-1">], {});</span><br/><span class="hl-1">    } </span><span class="hl-2">catch</span><span class="hl-1"> (</span><span class="hl-0">e</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-2">return</span><span class="hl-1"> </span><span class="hl-9">handleError</span><span class="hl-1">(</span><span class="hl-0">e</span><span class="hl-1">, </span><span class="hl-0">context</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code></pre>
<p>Then refresh the page and voilá! Data is now being fetched on the server.</p>
</div></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class=""><a href="../modules.html">Modules</a></li><li class=" pages-entry pages-entry-page pages-entry-depth-0"><a href="getting-started.html">Getting <wbr/>Started</a></li><li class="current pages-entry pages-entry-page pages-entry-depth-0"><a href="installing-from-scratch.html">Setting up the framework manually</a></li><li class=" tsd-kind-module"><a href="../modules/_10up_headless_core.html">@10up/headless-<wbr/>core</a></li><li class=" tsd-kind-module"><a href="../modules/_10up_headless_next.html">@10up/headless-<wbr/>next</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-namespace"><span class="tsd-kind-icon">Namespace</span></li><li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li><li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li><li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li><li class="tsd-kind-interface tsd-has-type-parameter"><span class="tsd-kind-icon">Interface with type parameter</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li><li class="tsd-kind-class tsd-has-type-parameter"><span class="tsd-kind-icon">Class with type parameter</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="../assets/main.js"></script></body></html>